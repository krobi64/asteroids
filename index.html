
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<title>Asteriod Analytics</title>


<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js"></script>

<script src="http://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.11/crossfilter.min.js"></script>


<!-- font awesome -->
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

<!-- our css -->
<link rel="stylesheet" href="includes/asteriods.css">


<script type="text/javascript">
$(document).ready(function(){
    $('[data-toggle="popover"]').popover({
    trigger: 'hover',
        'placement': 'top'
    });
    $('#radio-tom-modal').on('hidden.bs.modal', function (e) {
         $('#question-tom').val('');
     });

});
</script>

</head>

<body>

<div>

<h1>Asteriods Analytics</h1>


<h2>Mission</h2>
<p>blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah. blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah</p>
<br>
<br>
<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Ground Control</h3>
  </div>
  <div class="panel-body">
<p>Ask Major Tom a question or manipulate the filters yourself to find asteriods</p>
<br>
<br>
<div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"> Ask Major Tom...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="caret"></span></button>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">What is the most dangerous asteriod?</a></li>
    <li role="presentation" class="divider"></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Which is the closest asteriod to earth?</a></li>
    <li role="presentation" class="divider"></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" href="#">Which is the fastest asteriod?</a></li>
    <li role="presentation" class="divider"></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" data-toggle="modal" data-target="#radio-tom-modal">Radio Tom for More Questions...</a></li>
  </ul>
</div>

<!-- Radio Tom Modal Dialog -->
<div class="modal fade" id="radio-tom-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel"><span class="glyphicon glyphicon-bullhorn"></span>&nbsp;&nbsp;Radio Major Tom</h4>
      </div>
      <div class="modal-body">
        <p>Do you have a new question you want answered? Submit your question here and it will be radioed to Major Tom&hellip;</p>
<br>
<form>
    <label for="question-tom">Question</label>
    <input type="text" class="form-control" name="question-tom" id="question-tom" placeholder="What do you want to learn about?">
</form>
<br>
<div class="row">
  <div class="col-md-4">&nbsp;</div>
  <div class="col-md-4"><img class="helmet" src="images/helmet2.png" width="100px" height="100px"></div>
  <div class="col-md-4">&nbsp;</div>
</div>
<br>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" aria-hidden="true" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary"  aria-hidden="true" data-dismiss="modal">Notify Major Tom</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!-- END DIALOG -->

<br>


<!-- charts START --> 
<div id="charts">

  <div id="speed-chart" class="chart">
    <div class="title">Speed&nbsp;&nbsp;|&nbsp;&nbsp;<div href="#" class="label label-info" data-toggle="popover" title="Popover title" data-content="blah blah blah">Info</div><!-- &nbsp;&nbsp;<a href="#" class="label label-default">Reset</a> --></div> 
  </div>
  <div id="size-chart" class="chart">
    <div class="title">Size&nbsp;&nbsp;|&nbsp;&nbsp;<div href="#" class="label label-info" data-toggle="popover" title="Popover title" data-content="blah blah blah">Info</div><!-- &nbsp;&nbsp;<a href="#" class="label label-default">Reset</a> --></div> 
  </div>
  <div id="perihelion-distance-chart" class="chart">
    <div class="title">Nearest Distance to Sun&nbsp;&nbsp;|&nbsp;&nbsp;<div href="#" class="label label-info" data-toggle="popover" title="Popover title" data-content="blah blah blah">Info</div><!-- &nbsp;&nbsp;<a href="#" class="label label-default">Reset</a> --></div> 
  </div>
  <div id="earth-moid-chart" class="chart">
    <div class="title">Nearest Distance to Earth&nbsp;&nbsp;|&nbsp;&nbsp;<div href="#" class="label label-info" data-toggle="popover" title="Popover title" data-content="blah blah blah">Info</div><!-- &nbsp;&nbsp;<a href="#" class="label label-default">Reset</a> --></div> 
  </div>
</div>
<!-- charts END -->

<!-- search results -->
<div class="panel panel-default">

    <div class="panel-heading clearfix"> <h4 class="panel-title">Asteriods <span class="pull-right" style="font-size: .76em;">XXX of Asteriods Displayed</span></h4></div>
  
  <div class="panel-body">
    <table class="table">

    <thead>

        <tr>

            <th>Name</th>

            <th>Number/Designation</th>

            <th>Time to Oribit the Sun</th>

            <th>Energy to get to Asteroid</th>

            <th>Danger Risk</th>

        </tr>

    </thead>

    <tbody class="list">

<!--         <tr>

            <td>Casopeida</td>

            <td>123123899</td>

            <td>1 year</td>

            <td>30 Joules</td>

            <td>So far, so good.</td>

        </tr>

        <tr class="med-danger">

            <td>2</td>

            <td>Peter</td>

            <td>Parker</td>

            <td>30 Joules</td>

            <td>Danger Tom! (30 xyz)</td>

        </tr>

        <tr>

           <td>Casopeida</td>

            <td>123123899</td>

            <td>1 year</td>

            <td>30 Joules</td>

            <td>So far, so good.</td>

        </tr>

        <tr class="low-danger">

           <td>Casopeida</td>

            <td>123123899</td>

            <td>1 year</td>

            <td>30 Joules</td>

            <td >Low Danger (30 xyz)</td>

        </tr>


        <tr class="high-danger">

           <td>Casopeida</td>

            <td>123123899</td>

            <td>1 year</td>

            <td>30 Joules</td>

            <td >Super Danger Tom! (121 xyz)</td>

        </tr> -->

    </tbody>

</table>

  </div>
 <!--<div class="panel-footer"> XXX of Asteriods selected. </div>-->
 <!-- <div class="panel-footer"><aside id="totals"><span id="active">-</span> of <span id="total">-</span> asteroids selected.</aside></div>-->
</div>















<!-- closing of Ground Control-->
  </div>
</div>




<!--
<div id="lists">
  <div id="asteroid-list" class="list"></div>
</div>
-->

<footer>
  <span style="float:left;">
    <h6>Created by Team Nova</h6>
    <p><a href="http://en.wikipedia.org/wiki/Major_Tom" target="_blank">More about Major Tom...</a></p>
    Released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a>.<br>
    Leverage: Bootstrap, Fontawesome, Crossfilter (Square,Inc.)
</footer>




<script>

  var asteroids = [{
    "absolute_magnitude": 18.6,
    "aphelion_distance": 3.791,
    "designation": "63249 XB",
    "delta_v": 602.424,
    "earth_moid": 0.01825,
    "km_neo": false,
    "mean_daily_motion": 0.2979761,
    "n_or_d": "J79X00B",
    "name":"IDFU 234", 
    "neo":true,
    "number": null,
    "perihelion_distance": 0.849445272, 
    "period": 3.31,
    "pha":true,
    "torino_hazard_rating": 0,
    "id": 1
  },
  {
    "absolute_magnitude": 52.6,
    "aphelion_distance": 1.791,
    "designation": "1239 XB",
    "delta_v": 10.424,
    "earth_moid": 0.21825,
    "km_neo": false,
    "mean_daily_motion": 0.6979761,
    "n_or_d": "J79X00B",
    "name": "ROOD 23434", 
    "neo":true,
    "number": null,
    "perihelion_distance": 0.649445272, 
    "period": 1.31,
    "pha":true,
    "torino_hazard_rating": 0,
    "id": 2
  }]




  // Various formatters.
  var formatNumber = d3.format(",d"),
      formatChange = d3.format("+,d");


  // // A little coercion, since the CSV is untyped.
  // asteroids.forEach(function(d, i) {
  //   d.index = i;
  //   d.delay = +d.delay;
  //   d.distance = +d.distance;
  // });

  // Create the crossfilter for the relevant dimensions and groups.
  var asteroid = crossfilter(asteroids),
      all = asteroid.groupAll(),
      size = asteroid.dimension(function(d) { return Math.max(0, Math.min(150, +d.absolute_magnitude)); }),
      sizes = size.group(function(d) { return Math.floor(d / 10) * 10; }),
      speed = asteroid.dimension(function(d) { return Math.min(100, +d.mean_daily_motion); }),
      speeds = speed.group(function(d) { return Math.floor(d * 10) / 10.0; });
      earth_distance = asteroid.dimension(function(d) { return Math.min(1, +d.earth_moid); }),
      earth_distances = earth_distance.group(function(d) { return Math.floor(d * 10) / 10.0; }),
      sun_distance = asteroid.dimension(function(d) { return Math.min(1, +d.perihelion_distance); }),
      sun_distances = sun_distance.group(function(d) { return Math.floor(d * 10) / 10.0; }),
      designation = asteroid.dimension(function(d) { return d.designation});

  var charts = [

    // barChart()
    //     .dimension(hour)
    //     .group(hours)
    //   .x(d3.scale.linear()
    //     .domain([0, 24])
    //     .rangeRound([0, 10 * 24])),

    barChart()
        .dimension(speed)
        .group(speeds)
      .x(d3.scale.linear()
        .domain([0, 1])
        .rangeRound([0, 10 * 42])),

    barChart()
        .dimension(size)
        .group(sizes)
      .x(d3.scale.linear()
        .domain([0, 150])
        .rangeRound([0, 10 * 42])),

    barChart()
        .dimension(sun_distance)
        .group(sun_distances)
      .x(d3.scale.linear()
        .domain([0, 1])
        .rangeRound([0, 10 * 42])), 

    barChart()
        .dimension(earth_distance)
        .group(earth_distances)
      .x(d3.scale.linear()
        .domain([0, 1])
        .rangeRound([0, 10 * 42])),

     

    // barChart()
    //     .dimension(date)
    //     .group(dates)
    //     .round(d3.time.day.round)
    //   .x(d3.time.scale()
    //     .domain([new Date(2001, 0, 1), new Date(2001, 3, 1)])
    //     .rangeRound([0, 10 * 90]))
    //     .filter([new Date(2001, 1, 1), new Date(2001, 2, 1)])

  ];

  // Given our array of charts, which we assume are in the same order as the
  // .chart elements in the DOM, bind the charts to the DOM and render them.
  // We also listen to the chart's brush events to update the display.
  var chart = d3.selectAll(".chart")
      .data(charts)
      .each(function(chart) { chart.on("brush", renderAll).on("brushend", renderAll); });

  // Render the initial lists.
  var list = d3.selectAll(".list")
      .data([asteroidList]);

  // Render the total.
  d3.selectAll("#total")
      .text(formatNumber(asteroid.size()));

  renderAll();

  // Renders the specified chart or list.
  function render(method) {
    d3.select(this).call(method);
  }

  // Whenever the brush moves, re-rendering everything.
  function renderAll() {
    chart.each(render);
    list.each(render);
    d3.select("#active").text(formatNumber(all.value()));
  }

  window.filter = function(filters) {
    filters.forEach(function(d, i) { charts[i].filter(d); });
    renderAll();
  };

  window.reset = function(i) {
    charts[i].filter(null);
    renderAll();
  };

  function asteroidList(div) {
    // var asteroidsByDate = nestByDate.entries(date.top(40));

    // div.each(function() {
    //   var date = d3.select(this).selectAll(".date")
    //       .data(asteroidsByDate, function(d) { return d.key; });

    //   date.enter().append("div")
    //       .attr("class", "date")
    //     .append("div")
    //       .attr("class", "day")
    //       .text(function(d) { return formatDate(d.values[0].date); });

    //   date.exit().remove();
    div.each(function() {
      var asteroid = d3.select(this).selectAll(".asteroid")
          .data(designation.top(40), function(d) { return d.id; });

      var asteroidEnter = asteroid.enter().append("tr")
                                  .attr("class", "asteroid");

      asteroidEnter.append("td")
          .text(function(d) { return d.name; });

      asteroidEnter.append("td")
          .text(function(d) { return d.designation; });

      asteroidEnter.append("td")
          .text(function(d) { return d.period; });

      asteroidEnter.append("td")
          .text(function(d) { return d.delta_v; });          

      asteroid.exit().remove();

      asteroid.order();
    });
  }

  function barChart() {
    if (!barChart.id) barChart.id = 0;

    var margin = {top: 10, right: 10, bottom: 20, left: 10},
        x,
        y = d3.scale.linear().range([100, 0]),
        id = barChart.id++,
        axis = d3.svg.axis().orient("bottom"),
        brush = d3.svg.brush(),
        brushDirty,
        dimension,
        group,
        round;

    function chart(div) {
      var width = x.range()[1],
          height = y.range()[0];

      y.domain([0, group.top(1)[0].value]);

      div.each(function() {
        var div = d3.select(this),
            g = div.select("g");

        // Create the skeletal chart.
        if (g.empty()) {
          div.select(".title").append("a")
              .attr("href", "javascript:reset(" + id + ")")
              .attr("class", "reset")
              .text("reset")
              .style("display", "none");

          g = div.append("svg")
              .attr("width", width + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
            .append("g")
              .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

          g.append("clipPath")
              .attr("id", "clip-" + id)
            .append("rect")
              .attr("width", width)
              .attr("height", height);

          g.selectAll(".bar")
              .data(["background", "foreground"])
            .enter().append("path")
              .attr("class", function(d) { return d + " bar"; })
              .datum(group.all());

          g.selectAll(".foreground.bar")
              .attr("clip-path", "url(#clip-" + id + ")");

          g.append("g")
              .attr("class", "axis")
              .attr("transform", "translate(0," + height + ")")
              .call(axis);

          // Initialize the brush component with pretty resize handles.
          var gBrush = g.append("g").attr("class", "brush").call(brush);
          gBrush.selectAll("rect").attr("height", height);
          gBrush.selectAll(".resize").append("path").attr("d", resizePath);
        }

        // Only redraw the brush if set externally.
        if (brushDirty) {
          brushDirty = false;
          g.selectAll(".brush").call(brush);
          div.select(".title a").style("display", brush.empty() ? "none" : null);
          if (brush.empty()) {
            g.selectAll("#clip-" + id + " rect")
                .attr("x", 0)
                .attr("width", width);
          } else {
            var extent = brush.extent();
            g.selectAll("#clip-" + id + " rect")
                .attr("x", x(extent[0]))
                .attr("width", x(extent[1]) - x(extent[0]));
          }
        }

        g.selectAll(".bar").attr("d", barPath);
      });

      function barPath(groups) {
        var path = [],
            i = -1,
            n = groups.length,
            d;
        while (++i < n) {
          d = groups[i];
          path.push("M", x(d.key), ",", height, "V", y(d.value), "h9V", height);
        }
        return path.join("");
      }

      function resizePath(d) {
        var e = +(d == "e"),
            x = e ? 1 : -1,
            y = height / 3;
        return "M" + (.5 * x) + "," + y
            + "A6,6 0 0 " + e + " " + (6.5 * x) + "," + (y + 6)
            + "V" + (2 * y - 6)
            + "A6,6 0 0 " + e + " " + (.5 * x) + "," + (2 * y)
            + "Z"
            + "M" + (2.5 * x) + "," + (y + 8)
            + "V" + (2 * y - 8)
            + "M" + (4.5 * x) + "," + (y + 8)
            + "V" + (2 * y - 8);
      }
    }

    brush.on("brushstart.chart", function() {
      var div = d3.select(this.parentNode.parentNode.parentNode);
      div.select(".title a").style("display", null);
    });

    brush.on("brush.chart", function() {
      var g = d3.select(this.parentNode),
          extent = brush.extent();
      if (round) g.select(".brush")
          .call(brush.extent(extent = extent.map(round)))
        .selectAll(".resize")
          .style("display", null);
      g.select("#clip-" + id + " rect")
          .attr("x", x(extent[0]))
          .attr("width", x(extent[1]) - x(extent[0]));
      dimension.filterRange(extent);
    });

    brush.on("brushend.chart", function() {
      if (brush.empty()) {
        var div = d3.select(this.parentNode.parentNode.parentNode);
        div.select(".title a").style("display", "none");
        div.select("#clip-" + id + " rect").attr("x", null).attr("width", "100%");
        dimension.filterAll();
      }
    });

    chart.margin = function(_) {
      if (!arguments.length) return margin;
      margin = _;
      return chart;
    };

    chart.x = function(_) {
      if (!arguments.length) return x;
      x = _;
      axis.scale(x);
      brush.x(x);
      return chart;
    };

    chart.y = function(_) {
      if (!arguments.length) return y;
      y = _;
      return chart;
    };

    chart.dimension = function(_) {
      if (!arguments.length) return dimension;
      dimension = _;
      return chart;
    };

    chart.filter = function(_) {
      if (_) {
        brush.extent(_);
        dimension.filterRange(_);
      } else {
        brush.clear();
        dimension.filterAll();
      }
      brushDirty = true;
      return chart;
    };

    chart.group = function(_) {
      if (!arguments.length) return group;
      group = _;
      return chart;
    };

    chart.round = function(_) {
      if (!arguments.length) return round;
      round = _;
      return chart;
    };

    return d3.rebind(chart, brush, "on");
  }

</script>
</body>
</html>