
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="icon" type="image/png" href="images/MPClogo16.png">

<title>MPC: Asteroid Data Explorer - Control Panel </title>


<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.11/crossfilter.min.js"></script>


<!-- font awesome -->
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

<!-- our css -->
<link rel="stylesheet" href="css/asteroid-explorers.css">


<script type="text/javascript">
$(document).ready(function(){
    $('[data-toggle="popover"]').popover({
    trigger: 'hover',
        'placement': 'top'
    });
    $('[data-toggle="tooltip"]').tooltip({
    trigger: 'hover',
        'placement': 'top',
        container: 'body'
    });
});
</script>

</head>

<body>

<a name="top_page"></a>

<div class="ae-main">

  <div class="ae-header">

  <div id="ae-nav">
   <div id="ae-nav-header">
      <h1 class="ae-title"><i class="fa fa-compass"></i>&nbsp;MPC&nbsp;Asteroid&nbsp;Data&nbsp;Explorer</h1>
      <div class="btn-group ae-nav-btn-group" role="group">
        <a type="button" class="btn ae-nav-btn" href="index.html">Home</a>
        <a type="button" class="btn ae-nav-btn" href="ae-about.html">About</a>
        <a type="button" class="active btn ae-nav-btn" href="control-panel.html">Control Panel</a>
      </div>   
      <div id="ae-nav-header-actions">
        <!--<a href="index.html" class="btn ae-btn-default" role="button"><i class="fa fa-chevron-up"></i>&nbsp;Home</a>-->
      </div>

    </div>
  </div>

        <div id="ae-header-detail">
              <h2 class="ae-asteroid-title">Finding Asteroids Before They Find Us!</h2>

              <div id="ae-header-actions-2nd">
               <a href="https://twitter.com/intent/tweet?text=Explore+asteroids+with+Minor+Planet+Center+Asteroid+Data+Explorer+Project+&url=http://minorplanetcenter.com/mpc/index.html&hashtags=mpc,asteroids,asteroidexplorer" class="btn ae-btn-default" role="button"><i class="fa fa-twitter"></i>&nbsp;Share</a>
               </div>
               <br> <br> <br>
                <div class="ae-slogan">
     <span class="ae-highlight-big">Discover, Explore, and Share</span> information about asteroids to increase awareness about asteroids and their impact and risks to the world.<br>
    </div>
    </div>

  </div>

  <!-- START Ground Control -->
  <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Control Panel</h3>
      </div>

    <div class="panel-body clearfix">
      <p>Select a question to explore more about asteroids. You can then adjust the filters to refine and even craft your own exploration.
      <br>
      <br>
      <div class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown"> Select & Explore...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="caret"></span></button>
        <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
          <li role="presentation"><a role="menuitem" tabindex="-1" href="javascript:filter([[1.5, 2.0], [10, 20], null, [0.00, 0.02]])">Which are the most dangerous asteroids?</a></li>
          <li role="presentation" class="divider"></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="javascript:filter([null, null, null, [0.00, 0.01]])">Which are the biggest asteroids?</a></li>
          <li role="presentation" class="divider"></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="javascript:filter([[1.5,2.0], null, null, null])">Which asteroids are flying by the earth this month?</a></li>
          <li role="presentation" class="divider"></li>
          <li role="presentation"><a role="menuitem" tabindex="-1" href="javascript:filter([[1.5,2.0], null, null, null])">Which asteroids are easisest to travel to?</a></li>
        </ul>
      </div>


<!-- charts START -->
  <div id="charts">

    <div id="speed-chart" class="chart"><div class="title">Size (Meters)&nbsp;&nbsp;|&nbsp;&nbsp; <div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription">&nbsp;<span class="fa fa-info-circle fa-lg"></span>&nbsp;</div></div></div>
    
    <div id="size-chart" class="chart"><div class="title">Next Closest Approach to Earth<br>(Lunar&nbsp;Distance)&nbsp;&nbsp;|&nbsp;&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription">&nbsp;<span class="fa fa-info-circle fa-lg"></span>&nbsp;</div></div></div>
    
    <div id="perihelion-distance-chart" class="chart"><div class="title">Orbital Period&nbsp;&nbsp;|&nbsp;&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription">&nbsp;<span class="fa fa-info-circle fa-lg">&nbsp;</span></div></div></div>

    <div id="earth-moid-chart" class="chart"><div class="title">Energy to Travel to Asteroid (KM/Sec)&nbsp;&nbsp;|&nbsp;&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription">&nbsp;<span class="fa fa-info-circle fa-lg">&nbsp;</span></div></div></div>

  </div>
  <!-- charts END -->


  <!-- search results -->
  <div class="panel panel-default">

      <div class="panel-heading clearfix"><h4 class="panel-title ae-data-table-title">Asteroids<span class="pull-right ae-table-total">
      <div class="btn-group" role="group"><button type="button" class="btn active ae-table-toggle" data-toggle="tooltip" data-placement="top" title="Table View">&nbsp;<i class="fa fa-table fa-lg"></i>&nbsp;</button><button type="button" class="btn ae-table-toggle" data-toggle="tooltip" data-placement="top" title="Chart View">&nbsp;<i class="fa fa-area-chart fa-lg"></i>&nbsp;</button></div>&nbsp;&nbsp;|&nbsp;&nbsp;<span id="active">-</span> of <span id="total">-</span> Asteroids Displayed</span></h4></div>

    <div class="panel-body">
      <table class="table table-condensed">

      <thead class="ae-data-table">

          <tr>
              <th class="ae-data-table-header">Asteroid<br>Designation&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="bottom" title="someJSONColumnHeaderValue" data-content="someDescription"><span class="fa fa-info-circle fa-lg"></span></div></th>

              <th class="ae-data-table-header">Size (Meters)&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription"><span class="fa fa-info-circle fa-lg"></span></div></th>

              <th class="ae-data-table-header">Next Closest<br>Approach to Earth Date&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription"><span class="fa fa-info-circle fa-lg"></span></div></th>

              <th class="ae-data-table-header">Next Closest<br>Approach to Earth (Lunar&nbsp;Distance)&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription"><span class="fa fa-info-circle fa-lg"></span></div></th>

              <th class="ae-data-table-header">Orbital Period&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription"><span class="fa fa-info-circle fa-lg"></span></div></th>

              <th class="ae-data-table-header">Energy to Travel to Asteroid (KM/Sec)&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription"><span class="fa fa-info-circle fa-lg"></span></div></th>

              <th class="ae-data-table-header">PHA&nbsp;<div href="#" class="label label-info" data-toggle="popover" data-placement="above" title="someJSONColumnHeaderValue" data-content="someDescription"><span class="fa fa-info-circle fa-lg"></span></div></th>

              <th>Share</th>

          </tr>

      </thead>

      <tbody class="list">
  <!-- render via javascript -->
      </tbody>

  </table>

    </div>
  </div>

  <!-- CLOSE of Ground Control-->
    </div>
   </div>
  <!-- CLOSE of Ground Control-->

<a href="#top_page" class="btn pull-right ae-btn-top bottom-button" role="button"><i class="fa fa-caret-up"></i>&nbsp;Top&nbsp;</a>

  <!-- CLOSE of ae-main div-->
  </div>
  <!-- CLOSE of ae-main div-->

<script>
var twitter_share = function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}};

twitter_share(document, 'script', 'twitter-wjs');
  // var asteroids = [{
  //   "absolute_magnitude": 18.6,
  //   "aphelion_distance": 3.791,
  //   "designation": "63249 XB",
  //   "delta_v": 602.424,
  //   "earth_moid": 0.01825,
  //   "km_neo": false,
  //   "mean_daily_motion": 0.2979761,
  //   "n_or_d": "J79X00B",
  //   "name":"IDFU 234",
  //   "neo":true,
  //   "number": null,
  //   "perihelion_distance": 0.849445272,
  //   "period": 3.31,
  //   "pha":true,
  //   "torino_hazard_rating": 0,
  //   "id": 1
  // },
  // {
  //   "absolute_magnitude": 52.6,
  //   "aphelion_distance": 1.791,
  //   "designation": "1239 XB",
  //   "delta_v": 10.424,
  //   "earth_moid": 0.21825,
  //   "km_neo": false,
  //   "mean_daily_motion": 0.6979761,
  //   "n_or_d": "J79X00B",
  //   "name": "ROOD 23434",
  //   "neo":true,
  //   "number": null,
  //   "perihelion_distance": 0.649445272,
  //   "period": 1.31,
  //   "pha":true,
  //   "torino_hazard_rating": 0,
  //   "id": 2
  // }]



d3.json("ae/asteroids.json", function(error, asteroids_temp) {
  // Various formatters.
  var formatNumber = d3.format(",d"),
      formatChange = d3.format("+,d");


  var asteroids = [];
  // // A little coercion, since the CSV is untyped.
  asteroids_temp.forEach(function(d, i) {
    d.index = i;
    if(d.earth_moid != null) {
      asteroids.push(d)

    }
  });

  // Create the crossfilter for the relevant dimensions and groups.
  var asteroid = crossfilter(asteroids),
      all = asteroid.groupAll(),

      speed = asteroid.dimension(function(d) { return Math.min(100, +d.mean_daily_motion); }),
      speeds = speed.group(function(d) { return Math.floor(d * 10) / 10.0; });

      size = asteroid.dimension(function(d) { return Math.max(0, Math.min(150, +d.absolute_magnitude)); }),
      sizes = size.group(function(d) { return Math.floor(d); }),

      earth_distance = asteroid.dimension(function(d) { return Math.min(1, +d.earth_moid); }),
      earth_distances = earth_distance.group(function(d) { return Math.floor(d * 150) / 150.0; }),

      sun_distance = asteroid.dimension(function(d) { return Math.min(1, +d.perihelion_distance); }),
      sun_distances = sun_distance.group(function(d) { return Math.floor(d * 20) / 20.0; }),

      designation = asteroid.dimension(function(d) { return d.designation});

  var charts = [

    // barChart()
    //     .dimension(hour)
    //     .group(hours)
    //   .x(d3.scale.linear()
    //     .domain([0, 24])
    //     .rangeRound([0, 10 * 24])),

    barChart()
        .dimension(speed)
        .group(speeds)
      .x(d3.scale.linear()
        .domain([0, 2.0])
        .rangeRound([0, 10 * 20])),

    barChart()
        .dimension(size)
        .group(sizes)
      .x(d3.scale.linear()
        .domain([10, 35])
        .rangeRound([0, 10 * 25])),

    barChart()
        .dimension(sun_distance)
        .group(sun_distances)
      .x(d3.scale.linear()
        .domain([0, 1.2])
        .rangeRound([0, 10 * 24])),

    barChart()
        .dimension(earth_distance)
        .group(earth_distances)
      .x(d3.scale.linear()
        .domain([0, 0.5])
        .rangeRound([0, 10 * 75])),



    // barChart()
    //     .dimension(date)
    //     .group(dates)
    //     .round(d3.time.day.round)
    //   .x(d3.time.scale()
    //     .domain([new Date(2001, 0, 1), new Date(2001, 3, 1)])
    //     .rangeRound([0, 10 * 90]))
    //     .filter([new Date(2001, 1, 1), new Date(2001, 2, 1)])

  ];

  // Given our array of charts, which we assume are in the same order as the
  // .chart elements in the DOM, bind the charts to the DOM and render them.
  // We also listen to the chart's brush events to update the display.
  var chart = d3.selectAll(".chart")
      .data(charts)
      .each(function(chart) { chart.on("brush", renderAll).on("brushend", renderAll); });

  // Render the initial lists.
  var list = d3.selectAll(".list")
      .data([asteroidList]);

  // Render the total.
  d3.selectAll("#total")
      .text(formatNumber(asteroid.size()));

  renderAll();

  // Renders the specified chart or list.
  function render(method) {
    d3.select(this).call(method);
  }

  // Whenever the brush moves, re-rendering everything.
  function renderAll() {
    chart.each(render);
    list.each(render);
    d3.select("#active").text(formatNumber(all.value()));
  }

  window.filter = function(filters) {
    filters.forEach(function(d, i) { charts[i].filter(d); });
    renderAll();
  };

  window.reset = function(i) {
    charts[i].filter(null);
    renderAll();
  };

  function asteroidList(div) {
    // var asteroidsByDate = nestByDate.entries(date.top(40));

    // div.each(function() {
    //   var date = d3.select(this).selectAll(".date")
    //       .data(asteroidsByDate, function(d) { return d.key; });

    //   date.enter().append("div")
    //       .attr("class", "date")
    //     .append("div")
    //       .attr("class", "day")
    //       .text(function(d) { return formatDate(d.values[0].date); });

    //   date.exit().remove();
    div.each(function() {
      var asteroid = d3.select(this).selectAll(".asteroid")
          .data(designation.top(30), function(d) { return d.index; });

      var asteroidEnter = asteroid.enter().append("tr")
                                  .attr("class", function(d) {

                                    if (d.torino == null) {
                                      return "asteroid unknown-danger";
                                    } else if (+d.torino == 0) {
                                      return "asteroid";
                                    } else if (+d.torino == 1) {
                                      return "asteroid success";
                                    } else if (+d.torino == 2 || +d.torino == 3 || +d.torino == 4) {
                                      return "asteroid warning";
                                    } else if (+d.torino == 5 || +d.torino == 6 || +d.torino == 7) {
                                      return "asteroid med-danger";
                                    } else if (+d.torino == 8 || +d.torino == 9 || +d.torino == 10) {
                                      return "asteroid high-danger"
                                    }

                                  });

      // asteroidEnter.append("td")
      //     .text(function(d) { return d.name; });

      asteroidEnter.append("td")
          .append("a")
          .attr("href", "/asteroids/" + function(d) { return d.designation; })
          .text(function(d) { return d.designation; });



      asteroidEnter.append("td")
          .text(function(d) { return d.mean_daily_motion; });

      asteroidEnter.append("td")
          .text(function(d) { return d.absolute_magnitude; });

      asteroidEnter.append("td")
          .text(function(d) { return d.perihelion_distance; });

      asteroidEnter.append("td")
          .text(function(d) { return d.earth_moid; });

      asteroidEnter.append("td")
          .text(function(d) { return d.period; });

      asteroidEnter.append("td")
          .text(function(d) { return d.delta_v; });

      asteroidEnter.append("td")
          .text(function(d) {if (d.torino == null) {return "Unknown"} else { return d.torino }; });


// <a href="https://twitter.com/share" class="twitter-share-button"
// data-url="https://asteriod-explorers.herokuapp.com/adetail.html"
// data-text="Check out this Asteriod!"
// data-via=user_id
// data-related="asteriodexplore"
// data-count="none"
// data-hashtags="asteriodexplore, asteroids, nasa, seti">Tweet</a>

      asteroidEnter.append("td")
      .append("a")
      .attr("href","http://twitter.com/home/?status=Check out Asteroid XYZ! http://asteroid-explorers.herokuapp.com/XYZ.html %23asteroidexplore %23asteroids %23mpc %23nasa")
      .attr("target", "_blank")
      .attr("class", "btn btn-default btn-sm")
      .html("<span class='fa fa-twitter'></span> Tweet");

      asteroid.exit().remove();

      asteroid.order();
    });
  }

  function barChart() {
    if (!barChart.id) barChart.id = 0;

    var margin = {top: 10, right: 10, bottom: 20, left: 10},
        x,
        y = d3.scale.linear().range([100, 0]),
        id = barChart.id++,
        axis = d3.svg.axis().orient("bottom"),
        brush = d3.svg.brush(),
        brushDirty,
        dimension,
        group,
        round;

    function chart(div) {
      var width = x.range()[1],
          height = y.range()[0];

      y.domain([0, group.top(1)[0].value]);

      div.each(function() {
        var div = d3.select(this),
            g = div.select("g");

        // Create the skeletal chart.
        if (g.empty()) {

          div.select(".title").append("a")
              .attr("href", "javascript:reset(" + id + ")")
              .attr("class", "label label-default reset")
              .text("reset")
              .style("display", "none");

          g = div.append("svg")
              .attr("width", width + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
            .append("g")
              .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

          g.append("clipPath")
              .attr("id", "clip-" + id)
            .append("rect")
              .attr("width", width)
              .attr("height", height);

          g.selectAll(".bar")
              .data(["background", "foreground"])
            .enter().append("path")
              .attr("class", function(d) { return d + " bar"; })
              .datum(group.all());

          g.selectAll(".foreground.bar")
              .attr("clip-path", "url(#clip-" + id + ")");

          g.append("g")
              .attr("class", "axis")
              .attr("transform", "translate(0," + height + ")")
              .call(axis);

          // Initialize the brush component with pretty resize handles.
          var gBrush = g.append("g").attr("class", "brush").call(brush);
          gBrush.selectAll("rect").attr("height", height);
          gBrush.selectAll(".resize").append("path").attr("d", resizePath);
        }

        // Only redraw the brush if set externally.
        if (brushDirty) {
          brushDirty = false;
          g.selectAll(".brush").call(brush);
          div.select(".title a").style("display", brush.empty() ? "none" : null);
          if (brush.empty()) {
            g.selectAll("#clip-" + id + " rect")
                .attr("x", 0)
                .attr("width", width);
          } else {
            var extent = brush.extent();
            g.selectAll("#clip-" + id + " rect")
                .attr("x", x(extent[0]))
                .attr("width", x(extent[1]) - x(extent[0]));
          }
        }

        g.selectAll(".bar").attr("d", barPath);
      });

      function barPath(groups) {
        var path = [],
            i = -1,
            n = groups.length,
            d;
        while (++i < n) {
          d = groups[i];
          path.push("M", x(d.key), ",", height, "V", y(d.value), "h9V", height);
        }
        return path.join("");
      }

      function resizePath(d) {
        var e = +(d == "e"),
            x = e ? 1 : -1,
            y = height / 3;
        return "M" + (.5 * x) + "," + y
            + "A6,6 0 0 " + e + " " + (6.5 * x) + "," + (y + 6)
            + "V" + (2 * y - 6)
            + "A6,6 0 0 " + e + " " + (.5 * x) + "," + (2 * y)
            + "Z"
            + "M" + (2.5 * x) + "," + (y + 8)
            + "V" + (2 * y - 8)
            + "M" + (4.5 * x) + "," + (y + 8)
            + "V" + (2 * y - 8);
      }
    }

    brush.on("brushstart.chart", function() {
      var div = d3.select(this.parentNode.parentNode.parentNode);
      div.select(".title a").style("display", null);
    });

    brush.on("brush.chart", function() {
      var g = d3.select(this.parentNode),
          extent = brush.extent();
      if (round) g.select(".brush")
          .call(brush.extent(extent = extent.map(round)))
        .selectAll(".resize")
          .style("display", null);
      g.select("#clip-" + id + " rect")
          .attr("x", x(extent[0]))
          .attr("width", x(extent[1]) - x(extent[0]));
      dimension.filterRange(extent);
    });

    brush.on("brushend.chart", function() {
      if (brush.empty()) {
        var div = d3.select(this.parentNode.parentNode.parentNode);
        div.select(".title a").style("display", "none");
        div.select("#clip-" + id + " rect").attr("x", null).attr("width", "100%");
        dimension.filterAll();
      }
    });

    chart.margin = function(_) {
      if (!arguments.length) return margin;
      margin = _;
      return chart;
    };

    chart.x = function(_) {
      if (!arguments.length) return x;
      x = _;
      axis.scale(x);
      brush.x(x);
      return chart;
    };

    chart.y = function(_) {
      if (!arguments.length) return y;
      y = _;
      return chart;
    };

    chart.dimension = function(_) {
      if (!arguments.length) return dimension;
      dimension = _;
      return chart;
    };

    chart.filter = function(_) {
      if (_) {
        brush.extent(_);
        dimension.filterRange(_);
      } else {
        brush.clear();
        dimension.filterAll();
      }
      brushDirty = true;
      return chart;
    };

    chart.group = function(_) {
      if (!arguments.length) return group;
      group = _;
      return chart;
    };

    chart.round = function(_) {
      if (!arguments.length) return round;
      round = _;
      return chart;
    };

    return d3.rebind(chart, brush, "on");
  }
});

</script>


</body>
</html>
